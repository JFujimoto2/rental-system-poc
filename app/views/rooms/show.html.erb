<% content_for :title, "#{@room.building.name} #{@room.room_number}" %>

<p class="notice"><%= notice %></p>

<h1><%= @room.building.name %> <%= @room.room_number %></h1>

<table class="detail-table">
  <tr><th>建物</th><td><%= link_to @room.building.name, @room.building %></td></tr>
  <tr><th>部屋番号</th><td><%= @room.room_number %></td></tr>
  <tr><th>階数</th><td><%= @room.floor %></td></tr>
  <tr><th>間取り</th><td><%= @room.room_type %></td></tr>
  <tr><th>面積</th><td><%= "#{@room.area} ㎡" if @room.area %></td></tr>
  <tr><th>賃料</th><td><%= number_to_currency(@room.rent, unit: "¥", precision: 0) if @room.rent %></td></tr>
  <tr><th>状態</th><td><%= @room.status_label %></td></tr>
  <tr><th>備考</th><td><%= @room.notes %></td></tr>
</table>

<div class="actions-bar">
  <%= link_to "編集", edit_room_path(@room), class: "btn" %>
  <%= link_to "一覧に戻る", rooms_path, class: "btn" %>
  <%= button_to "削除", @room, method: :delete, class: "btn btn-danger", data: { turbo_confirm: "#{@room.room_number} を削除しますか？" } %>
</div>

<h2>契約履歴</h2>

<% if @room.contracts.any? %>
  <table>
    <thead>
      <tr>
        <th>入居者</th>
        <th>借家種別</th>
        <th>契約開始日</th>
        <th>契約終了日</th>
        <th>月額賃料</th>
        <th>状態</th>
      </tr>
    </thead>
    <tbody>
      <% @room.contracts.includes(:tenant).order(start_date: :desc).each do |contract| %>
        <tr>
          <td><%= link_to contract.tenant.name, contract.tenant %></td>
          <td><%= contract.lease_type_label %></td>
          <td><%= contract.start_date %></td>
          <td><%= contract.end_date %></td>
          <td><%= number_to_currency(contract.rent, unit: "¥", precision: 0) if contract.rent %></td>
          <td><%= link_to contract.status_label, contract %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>契約履歴がありません。</p>
<% end %>
